<!DOCTYPE html>
<html><head lang="en"><script src="/archie/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=archie/livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Crypto Lab 2 - Using Asymmetric keys - Hands On Cybersecurity Learning Blog</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="This is our second Crypto Lab that shows the usage of asymmetric keys" />
	<meta property="og:image" content=""/>
	<meta property="og:url" content="http://localhost:1313/archie/posts/asymmetric/">
  <meta property="og:site_name" content="Hands On Cybersecurity Learning Blog">
  <meta property="og:title" content="Crypto Lab 2 - Using Asymmetric keys">
  <meta property="og:description" content="This is our second Crypto Lab that shows the usage of asymmetric keys">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-03T00:00:00+00:00">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Crypto Lab 2 - Using Asymmetric keys">
  <meta name="twitter:description" content="This is our second Crypto Lab that shows the usage of asymmetric keys">
<script src="http://localhost:1313/archie/js/feather.min.js"></script>
	
	
        <link href="http://localhost:1313/archie/css/fonts.11a1877508139eac0b5b4852ceb110c35641b3533321e66e39149e901ed5756b.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/archie/css/main.13be42446d1bfba541b5d924ab3b7f0bca079b91c46b645ffe317b0561fb4bf0.css" />

	
	
		<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>

		
		<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script>
	

	
	
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css">
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"></script>
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

		
		<script>
			document.addEventListener("DOMContentLoaded", function() {
					renderMathInElement(document.body, {
							delimiters: [
									{left: "$$", right: "$$", display: true},
									{left: "$", right: "$", display: false}
							]
					});
			});
			</script>
	

	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="http://localhost:1313/">Hands On Cybersecurity Learning Blog</a>
	</div>
	<nav>
		
		<a href="/archie/posts">Home</a>
		
		<a href="/archie/posts">All posts</a>
		
		<a href="/archie/about/about">About</a>
		
		<a href="/archie/tags">Tags</a>
		
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Crypto Lab 2 - Using Asymmetric keys</h1>
			<div class="meta">Posted on Jan 3, 2024</div>
		</div>
		

		

		<section class="body">
			<p>Asymmetric encryption, also known as public key cryptography, uses a pair of keys: a public key for encryption and a private key for decryption. Each user has a key pair, and anything encrypted with one key can be decrypted with the other key from the same pair.</p>
<p>Please refer to <a href="posts%5Clinux_prereq_crypto.md">pre-requisite</a> for this blog to ensure that you have two users setup on Linux.</p>
<h3 id="scenario">Scenario</h3>
<ul>
<li><strong>mikey</strong> wants to send an encrypted file to <strong>bart</strong>.</li>
<li>mikey uses bart&rsquo;s public key to encrypt the file.</li>
<li>bart uses his private key to decrypt the file.</li>
<li>The file to be encrypted is <code>turing_bio</code> stored at <code>/srv/shared</code></li>
</ul>
<hr>
<h3 id="barts-side-generating-the-keys">bart&rsquo;s Side (Generating the keys)</h3>
<ol>
<li><strong>bart</strong> generates a key pair (public and private keys):</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>   gpg --gen-key
</span></span></code></pre></div><p>Follow the prompts to generate the key pair. bart will need to provide his name, email address, and a passphrase. Here&rsquo;s the sample output</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>    GnuPG needs to construct a user ID to identify your key.
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>   Real name: RN
</span></span><span style="display:flex;"><span>   Name must be at least 5 characters long
</span></span><span style="display:flex;"><span>   Real name: bart12345
</span></span><span style="display:flex;"><span>   Email address: bart12345@gmail.com
</span></span><span style="display:flex;"><span>   You selected this USER-ID:
</span></span><span style="display:flex;"><span>      &#34;bart12345 &lt;bart12345@gmail.com&gt;&#34;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>   ....public and secret key created and signed.
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>   pub   rsa3072 2024-12-10 [SC] [expires: 2026-12-10]
</span></span><span style="display:flex;"><span>         A6F6AFC9E969E6951FCE5DDC08C537A5ECE4F89D
</span></span><span style="display:flex;"><span>   uid                      Rn12345 &lt;rn12345@gmail.com&gt;
</span></span><span style="display:flex;"><span>   sub   rsa3072 2024-12-10 [E] [expires: 2026-12-10]
</span></span></code></pre></div><ol start="2">
<li><strong>bart</strong> exports his public key to a file:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>   gpg --export -a <span style="color:#e6db74">&#34;bart12345&#34;</span> &gt; bart_public.key
</span></span></code></pre></div><p>This creates a file <code>bart_public.key</code> containing bart&rsquo;s public key.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>   cat  bart_public.key
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>   -----BEGIN PGP PUBLIC KEY BLOCK-----
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>   mQGNBGdY...............
</span></span><span style="display:flex;"><span>   ............
</span></span><span style="display:flex;"><span>   =7ZXt
</span></span><span style="display:flex;"><span>   -----END PGP PUBLIC KEY BLOCK-----
</span></span></code></pre></div><h3 id="mikeys-side-encrypting-the-file">mikey&rsquo;s Side (Encrypting the File)</h3>
<ol>
<li><strong>mikey</strong> imports bart&rsquo;s public key:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>   gpg --import bart_public.key
</span></span></code></pre></div><ol start="2">
<li><strong>mikey</strong> encrypts the file using <strong>bart&rsquo;s public key</strong>:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gpg --output turing_bio_asymmetric_enc.gpg --encrypt --recipient <span style="color:#e6db74">&#34;bart12345&#34;</span> turing_bio
</span></span></code></pre></div></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>   The resulting `turing_bio_asymmetric_enc.gpg` is the encrypted version of the file
</span></span><span style="display:flex;"><span>   ```bash   
</span></span><span style="display:flex;"><span>   &gt;head turing_bio_asymmetric_enc.gpg 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>   ����^�b5�   
</span></span></code></pre></div><h3 id="barts-side-decrypting-the-file">bart&rsquo;s Side (Decrypting the File)</h3>
<ol>
<li><strong>bart</strong> decrypts the file using his <strong>private key</strong>:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>   &gt;gpg --output turing_bio_asymmetric_dec --decrypt turing_bio_asymmetric_enc.gpg
</span></span></code></pre></div><ol start="2">
<li><strong>bart</strong> can now read the decrypted message and check that it is identical to original:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>   &gt;diff turing_bio turing_bio_asymmetric_dec
</span></span></code></pre></div><h3 id="private-key-details">Private key details</h3>
<p>When you use <code>gpg --decrypt</code> to decrypt a file, it requires the corresponding private key that matches the public key used to encrypt the file. This private key is stored in your GPG keyring. Here are some details about where and how the private key is stored:</p>
<h3 id="accessing-your-keyring">Accessing Your Keyring</h3>
<p>To list the private keys in your keyring, you can use the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gpg --list-secret-keys
</span></span></code></pre></div><p>This command will output details about the private keys available in your keyring.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>/home/bart/.gnupg/pubring.kbx
</span></span><span style="display:flex;"><span>------------------------------
</span></span><span style="display:flex;"><span>sec   rsa3072 2024-12-10 [SC] [expires: 2026-12-10]
</span></span><span style="display:flex;"><span>      A6F6AFC9E969E6951FCE5DDC08C537A5ECE4F89D
</span></span><span style="display:flex;"><span>uid           [ultimate] bart12345 &lt;bart12345@gmail.com&gt;
</span></span><span style="display:flex;"><span>ssb   rsa3072 2024-12-10 [E] [expires: 2026-12-10]
</span></span></code></pre></div><h3 id="backing-up-the-private-key">Backing up the private key</h3>
<ul>
<li><strong>Passphrase Protection</strong>: Your private key is usually protected by a passphrase, which you set when you generated the key pair. This adds an additional layer of security.</li>
<li><strong>Backup</strong>: It&rsquo;s important to keep a secure backup of your private key and remember your passphrase. Losing either means you won&rsquo;t be able to decrypt files encrypted with the corresponding public key.</li>
</ul>
<p>Here&rsquo;s how to do that</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gpg --export-secret-keys -a <span style="color:#e6db74">&#34;Rn12345&#34;</span> &gt; private-key-backup.asc
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat private-key-backup.asc 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>-----BEGIN PGP PRIVATE KEY BLOCK-----
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>lQWGBG ...........
</span></span><span style="display:flex;"><span>=8Ju6
</span></span><span style="display:flex;"><span>-----END PGP PRIVATE KEY BLOCK-----
</span></span></code></pre></div><h3 id="high-level-concepts-to-remember">High Level concepts to remember</h3>
<ul>
<li><strong>Public Key</strong>: Can be shared openly. It&rsquo;s used for encrypting messages.</li>
<li><strong>Private Key</strong>: Must be kept secure. It&rsquo;s used for decrypting messages and signing.</li>
</ul>

		</section>

		<div class="post-tags">
			
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/rnayaksec" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://x.com/rnayaksec" rel="me" title="X"><i data-feather="twitter"></i></a>
    <a class="border"></a><a class="soc" href="https://www.linkedin.com/in/rohitnayak/" rel="me" title="LinkedIn"><i data-feather="linkedin"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2024  © Rohit Nayak |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>
<script>
  feather.replace()
</script></div>
    </body>
</html>
